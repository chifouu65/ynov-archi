# LIVRABLE SÉANCE 3 : Choix du Style Architectural

**Document :** Justification du Style Architectural
**Date :** Séance 3
**Statut :** Validé

## 1. Comparaison des Styles Architecturaux

Pour définir l'architecture de la plateforme SaaS, nous avons analysé trois styles standards au regard des contraintes du projet (maintenabilité, évolutivité, équipe junior).

| Critère | **MVC (Model-View-Controller)** | **Architecture en Couches (N-Tier)** | **SOA / Micro-services** |
| --- | --- | --- | --- |
| **Principe** | Séparation Interface / Données. | Séparation technique stricte (Présentation, Métier, Data). | Découpage en services distribués autonomes communiquant via réseau. |
| **Avantages** | Rapide à mettre en place pour le Web. | Standard industriel, excellente testabilité, code organisé. | Scalabilité extrême, indépendance technologique totale. |
| **Inconvénients** | Tendance au "Code Spaghetti" si le contrôleur grossit trop. | Risque de dépendances si les couches ne sont pas strictes. | Complexité d'infrastructure énorme (réseau, latence, déploiement). |
| **Verdict Projet** | ❌ Insuffisant pour une architecture globale (utilisé uniquement en couche Présentation). | ✅ **Retenu** (Le meilleur compromis structure/complexité). | ❌ Trop complexe pour l'infrastructure actuelle (mais on s'en inspire pour la modularité). |

## 2. Le Choix : Architecture en Couches Stricte & Modulaire

Nous retenons une **Architecture en Couches (Layered Architecture)** combinée à une approche **Modulaire (Modular Monolith)**.

### Pourquoi ce choix ? (Justification)

#### A. Justification Métier (Business)

* **Sécurité des données :** La couche de présentation (API) n'a jamais accès direct à la base de données. Cela protège les données sensibles des clients B2B.
* **Évolutivité fonctionnelle :** Si nous devons changer la façon de calculer les factures (Métier), nous ne touchons pas à l'interface graphique (Présentation) ni au stockage (Persistence).

#### B. Justification Technique

* **Testabilité (Qualité) :** L'architecture en couches permet de tester la couche "Service" de manière isolée en "bouchonnant" (Mock) la base de données. C'est une exigence clé du projet.
* **Parallélisation du développement :** Un développeur peut travailler sur le moteur de facturation (Backend) pendant qu'un autre travaille sur l'API (Frontend) sans se bloquer, grâce aux contrats d'interface.
* **Préparation aux Micro-services :** En appliquant une modularité stricte maintenant, nous pourrons détacher un module (ex: `Billing`) pour en faire un micro-service réel dans le futur avec un effort minime.

---

# LIVRABLE SÉANCE 4 : Architecture Modulaire (Maven)

**Document :** Structure Technique & Configuration Maven
**Date :** Séance 4
**Objectif :** Mise en œuvre physique de l'architecture.

## 1. Stratégie de Découpage Maven

Pour imposer physiquement l'architecture définie en Séance 2 et 3, nous utilisons un projet **Maven Multi-modules**.
Le projet parent `pom.xml` ne contient pas de code, il pilote la configuration globale.

### 1.1. Arborescence du Projet

```text
saas-fil-rouge (Root / Aggregator)
├── pom.xml (Parent: gère les versions Spring Boot, JUnit, etc.)
│
├── saas-kernel (Shared Kernel)
│   └── Responsabilité : Code technique commun (Exceptions, Utils).
│       ⚠️ INTERDICTION : Ne dépend d'aucun autre module.
│
├── saas-identity (Domaine Utilisateurs)
│   └── Responsabilité : Auth, Users, Company.
│
├── saas-ticketing (Domaine Support)
│   └── Responsabilité : Tickets, SLA.
│
├── saas-billing (Domaine Facturation)
│   └── Responsabilité : Invoices, Plans.
│
├── saas-reporting (Domaine Pilotage)
│   └── Responsabilité : Dashboards.
│
└── saas-api (Bootstrapper)
    └── Responsabilité : Contient le `main()`, les Contrôleurs REST.
    └── Assemble l'application finale.

```

## 2. Définition des Dépendances (Le Grappin Maven)

Le fichier `pom.xml` parent définit le graphe de dépendance pour éviter les cycles.

### 2.1. Extrait du POM Parent (`saas-fil-rouge/pom.xml`)

Ce fichier centralise les versions pour garantir que tous les modules utilisent les mêmes librairies.

```xml
<project>
    <groupId>com.saas.b2b</groupId>
    <artifactId>saas-fil-rouge</artifactId>
    <version>1.0.0-SNAPSHOT</version>
    <packaging>pom</packaging>

    <modules>
        <module>saas-kernel</module>
        <module>saas-identity</module>
        <module>saas-ticketing</module>
        <module>saas-billing</module>
        <module>saas-reporting</module>
        <module>saas-api</module>
    </modules>

    <dependencyManagement>
        <dependencies>
            <dependency>
                <groupId>com.saas.b2b</groupId>
                <artifactId>saas-kernel</artifactId>
                <version>${project.version}</version>
            </dependency>
            </dependencies>
    </dependencyManagement>
</project>

```

### 2.2. Exemple de Module Métier (`saas-ticketing/pom.xml`)

Le module de tickets a besoin du noyau technique et de savoir qui sont les utilisateurs, mais il ne doit rien savoir de la facturation.

```xml
<project>
    <parent>
        <groupId>com.saas.b2b</groupId>
        <artifactId>saas-fil-rouge</artifactId>
        <version>1.0.0-SNAPSHOT</version>
    </parent>
    <artifactId>saas-ticketing</artifactId>

    <dependencies>
        <dependency>
            <groupId>com.saas.b2b</groupId>
            <artifactId>saas-kernel</artifactId>
        </dependency>

        <dependency>
            <groupId>com.saas.b2b</groupId>
            <artifactId>saas-identity</artifactId>
        </dependency>
        
        </dependencies>
</project>

```

### 2.3. Matrice des flux de dépendances

Ce tableau valide l'absence de cycles (critère de qualité).

| Module | Dépend de (Maven) | Raison technique |
| --- | --- | --- |
| `saas-kernel` | *Aucun (Java pur)* | Bibliothèque de base. |
| `saas-identity` | `saas-kernel` | Utilise les exceptions techniques. |
| `saas-ticketing` | `saas-identity`, `saas-kernel` | Besoin des objets `User`. |
| `saas-billing` | `saas-identity`, `saas-kernel` | Besoin des objets `Company`. |
| `saas-reporting` | `saas-ticketing`, `saas-billing` | Besoin des données pour stats. |
| `saas-api` | **TOUS** | Doit charger tous les beans au démarrage. |

